# Automate End of Duty Tasks Windows

The `process_duty_email.py` python `get_DNAnexus_url.ps1` PowerShell scripts are required to download files using the URL links located in the CSV files that are generated by the `automate_duty.py` script in the [Automate_Duty_Docker/Atumate_Duty](https://github.com/moka-guys/Automate_Duty/tree/develop/Automate_Duty_Docker/Automate_Duty) folder.

These scripts are located on the Guy's and St Thomas' Trust computer at the following location: 

~~~
S:\Genetics_Data2\Array\Software\duty_bioinformatician_scripts
~~~

This script can be added to the PowerShell Profile on the trsut computer as follows:
Open PowerShell
Type:
~~~
notepad $profile
~~~
In the notepad add the following lines:
~~~
Set-Alias -Name python3 -Value \\gstt.local\shared\Genetics_Data2\Array\Software\Python-3.6.5\python.exe

function runprocessdutyemail {python3 \\gstt.local\shared\Genetics_Data2\Array\Software\duty_bioinformatician_scripts\process_duty_email.py}

Set-Alias -Name duty -Value runprocessdutyemail
~~~

These instructions are also located in this KB article: 

~~~
https://viapath.service-now.com/nav_to.do?uri=%2Fkb_view.do%3Fsys_kb_id%3Df076201c1b4cd5500dc321f6b04bcbc7
~~~


The duty bioinformatician has to save the csv file in the following folder:

~~~
P:\Bioinformatics\Duty_Bioinformatics_CSV
~~~

Once the PowerShell Profile has been set up, to run the script simply open the PowerShell and type:

~~~
duty
~~~

The duty python script will read the csv file and will send a command to PowerShell to download the files to appropriate folders. The script will also archive the csv file to the archive folder. Furthermore, the script will produce a log file fo the output of the Powershell Downloads to the log folder. These folders are located on the GSTT computer here:

~~~
P:\Bioinformatics\Duty_Bioinformatics_CSV\archive
P:\Bioinformatics\Duty_Bioinformatics_CSV\process_logs
~~~

Alternatively, this script can be executed manually on a Trust PC using this command:

~~~
S:\Genetics_Data2\Array\Software\Python-3.6.5\python S:\Genetics_Data2\Array\Software\duty_bioinformatician_scripts\process_duty_email.py

~~~

# Developers
Igor Malashchuk <br />
STP Trainee in Clinical Bioinformatics <br />
Guy's and St Thomas's NHS Trust <br />
Date modified: 2nd September 2022